{"remainingRequest":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\src\\components\\Trend.vue?vue&type=style&index=0&id=0041d71d&lang=less&scoped=true&","dependencies":[{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\src\\components\\Trend.vue","mtime":1614924310811},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Webstorm_program\\Echarts-Vue\\Day03\\Echarts-Vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnRpdGxlIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMjBweDsKICB0b3A6IDIwcHg7CiAgei1pbmRleDogMTA7CiAgY29sb3I6IHdoaXRlOwogIC50aXRsZS1pY29uIHsKICAgIG1hcmdpbi1sZWZ0OiAxMHB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KICAuc2VsZWN0LWNvbiB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjIyNzMzOwogIH0KfQo="},{"version":3,"sources":["Trend.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Trend.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"com-container\">\n    <div class=\"title\" :style=\"comStyle\">\n      <span>{{ '❤ ' +  showTitle }}</span>\n      <span class=\"iconfont title-icon\" :style=\"comStyle\"  @click=\"showChoice = !showChoice\">&#xe6eb;</span>\n      <div class=\"select-con\" v-show=\"showChoice\" :style=\"marginStyle\">\n        <div class=\"select-item\" v-for=\"item in selectTypes\" :key=\"item.key\" @click=\"handleSelect(item.key)\">\n          {{ item.text }}\n        </div>\n      </div>\n    </div>\n    <div class=\"com-chart\" ref=\"trend_ref\"></div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { getThemeValue } from '@/utils/theme_utils'\nexport default {\n  data () {\n    return {\n      chartInstane: null,\n      allData: null, // 从服务器中获取的所有数据\n      showChoice: false, // 是否显示可选项\n      choiceType: 'map', // 显示的数据类型\n      titleFontSize: 0 // 指明标题的字体大小\n    }\n  },\n  created () {\n    // 在组件创建完成之后 进行回调函数的注册\n    this.$socket.registerCallBack('trendData', this.getData)\n  },\n  mounted () {\n    this.initChart()\n    // this.getData()\n    // 发送数据给服务器, 告诉服务器, 我现在需要数据\n    this.$socket.send({\n      action: 'getData',\n      socketType: 'trendData',\n      chartName: 'trend',\n      value: ''\n    })\n    window.addEventListener('resize', this.screenAdapter)\n    this.screenAdapter()\n  },\n  destroyed () {\n    window.removeEventListener('resize', this.screenAdapter)\n    // 在组件销毁的时候, 进行回调函数的取消\n    this.$socket.unRegisterCallBack('trendData')\n  },\n  computed: {\n    selectTypes () {\n      if (!this.allData) {\n        return []\n      } else {\n        return this.allData.type.filter(item => {\n          return item.key !== this.choiceType\n        })\n      }\n    },\n    showTitle () {\n      if (!this.allData) {\n        return ''\n      } else {\n        return this.allData[this.choiceType].title\n      }\n    },\n    // 设置给标题的样式\n    comStyle () {\n      return {\n        fontSize: this.titleFontSize + 'px',\n        color: getThemeValue(this.theme).titleColor\n      }\n    },\n    marginStyle () {\n      return {\n        marginLeft: this.titleFontSize + 'px'\n      }\n    },\n    ...mapState(['theme'])\n  },\n  methods: {\n    initChart () {\n      this.chartInstane = this.$echarts.init(this.$refs.trend_ref, this.theme)\n      const initOption = {\n        grid: {\n          left: '3%',\n          top: '35%',\n          right: '4%',\n          bottom: '1%',\n          containLabel: true\n        },\n        tooltip: {\n          trigger: 'axis'\n        },\n        legend: {\n          left: 20,\n          top: '15%',\n          icon: 'circle'\n        },\n        xAxis: {\n          type: 'category',\n          boundaryGap: false\n        },\n        yAxis: {\n          type: 'value'\n        }\n      }\n      this.chartInstane.setOption(initOption)\n    },\n    // ret 就是服务端发送给客户端的图表的数据\n    getData (ret) {\n      // await this.$http.get()\n      // 对allData进行赋值\n      // const { data: ret } = await this.$http.get('trend')\n      this.allData = ret\n      console.log(this.allData)\n      this.updateChart()\n    },\n    updateChart () {\n      // 半透明的颜色值\n      const colorArr1 = [\n        'rgba(11, 168, 44, 0.5)',\n        'rgba(44, 110, 255, 0.5)',\n        'rgba(22, 242, 217, 0.5)',\n        'rgba(254, 33, 30, 0.5)',\n        'rgba(250, 105, 0, 0.5)'\n      ]\n      // 全透明的颜色值\n      const colorArr2 = [\n        'rgba(11, 168, 44, 0)',\n        'rgba(44, 110, 255, 0)',\n        'rgba(22, 242, 217, 0)',\n        'rgba(254, 33, 30, 0)',\n        'rgba(250, 105, 0, 0)'\n      ]\n      // 处理数据\n      // 类目轴的数据\n      const timeArr = this.allData.common.month\n      // y轴的数据 series下的数据\n      const valueArr = this.allData[this.choiceType].data\n      const seriesArr = valueArr.map((item, index) => {\n        return {\n          name: item.name,\n          type: 'line',\n          data: item.data,\n          stack: this.choiceType,\n          areaStyle: {\n            color: new this.$echarts.graphic.LinearGradient(0, 0, 0, 1, [\n              {\n                offset: 0,\n                color: colorArr1[index]\n              }, // %0的颜色值\n              {\n                offset: 1,\n                color: colorArr2[index]\n              } // 100%的颜色值\n            ])\n          }\n        }\n      })\n      // 图例的数据\n      const legendArr = valueArr.map(item => {\n        return item.name\n      })\n      const dataOption = {\n        xAxis: {\n          data: timeArr\n        },\n        legend: {\n          data: legendArr\n        },\n        series: seriesArr\n      }\n      this.chartInstane.setOption(dataOption)\n    },\n    screenAdapter () {\n      this.titleFontSize = this.$refs.trend_ref.offsetWidth / 100 * 3.6\n      const adapterOption = {\n        legend: {\n          itemWidth: this.titleFontSize,\n          itemHeight: this.titleFontSize,\n          itemGap: this.titleFontSize,\n          textStyle: {\n            fontSize: this.titleFontSize / 2\n          }\n        }\n      }\n      this.chartInstane.setOption(adapterOption)\n      this.chartInstane.resize()\n    },\n    handleSelect (currentType) {\n      this.choiceType = currentType\n      this.updateChart()\n      this.showChoice = false\n    }\n  },\n  watch: {\n    theme () {\n      console.log('主题切换了')\n      this.chartInstane.dispose() // 销毁当前的图表\n      this.initChart() // 重新以最新的主题名称初始化图表对象\n      this.screenAdapter() // 完成屏幕的适配\n      this.updateChart() // 更新图表的展示\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.title {\n  position: absolute;\n  left: 20px;\n  top: 20px;\n  z-index: 10;\n  color: white;\n  .title-icon {\n    margin-left: 10px;\n    cursor: pointer;\n  }\n  .select-con {\n    background-color: #222733;\n  }\n}\n</style>\n"]}]}